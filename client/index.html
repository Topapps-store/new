<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <title>TopApps.store - Download Popular Android Apps</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <style>
      /* Ocultar solo elementos visuales, pero permitir que el widget funcione */
      .goog-te-banner-frame.skiptranslate {
        display: none !important;
      }
      body {
        top: 0 !important;
      }
      /* Hacemos esto invisible pero funcional */
      #google_translate_element {
        position: fixed;
        bottom: 10px;
        right: 10px;
        opacity: 0.01;
        z-index: 9999;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>

    <div id="google_translate_element"></div>

    <script>
      window.googleTranslateElementInit = function () {
        new google.translate.TranslateElement({
          pageLanguage: 'en',
          includedLanguages: 'ar,de,en,es,fr,hi,id,it,ja,ko,nl,pt,ru,th,tr,vi,zh-CN',
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
          autoDisplay: true
        }, 'google_translate_element');
      };
    </script>

    <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async defer></script>

    <script>
      // Intenta forzar la traducciÃ³n si Google carga correctamente
      const tryTranslate = () => {
        const combo = document.querySelector('.goog-te-combo');
        console.log('Trying to find Google Translate element:', combo);
        const lang = (navigator.language || 'en').split('-')[0];
        if (combo && lang !== 'en') {
          console.log('Setting language to:', lang);
          combo.value = lang;
          combo.dispatchEvent(new Event('change'));
        } else {
          console.log('Waiting for Google Translate to load...');
          setTimeout(tryTranslate, 1000); // Increased timeout
        }
      };

      // Try multiple times with increasing delay
      let attempts = 0;
      const maxAttempts = 10;
      
      const initTranslation = () => {
        if (attempts < maxAttempts) {
          attempts++;
          console.log(`Translation attempt ${attempts}/${maxAttempts}`);
          setTimeout(tryTranslate, 1000 * attempts);
        }
      };

      window.addEventListener('load', initTranslation);
      
      // Additional attempt when Google script loads
      document.querySelector('script[src*="translate_a/element.js"]')?.addEventListener('load', () => {
        console.log('Google Translate script loaded');
        setTimeout(tryTranslate, 1500);
      });
    </script>

  </body>
</html>
